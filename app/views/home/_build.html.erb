<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
</head>
<%# <%= javascript_pack_tag 'lib/axios/dist/axios' %1> %>
<%# <%= javascript_pack_tag 'lib/CryptoJS/rollups/hmac-sha256' %1> %>
<%# <%= javascript_pack_tag 'lib/CryptoJS/rollups/sha256' %1> %>
<%# <%= javascript_pack_tag 'lib/CryptoJS/components/hmac' %1> %>
<%# <%= javascript_pack_tag 'lib/CryptoJS/components/enc-base64' %1> %>
<%# <%= javascript_pack_tag 'lib/url-template/url-template' %1> %>
<%# <%= javascript_pack_tag 'lib/apiGatewayCore/sigV4Client' %1> %>
<%# <%= javascript_pack_tag 'lib/apiGatewayCore/apiGatewayClient' %1> %>
<%# <%= javascript_pack_tag 'lib/apiGatewayCore/simpleHttpClient' %1> %>
<%# <%= javascript_pack_tag 'lib/apiGatewayCore/utils' %1> <!-- <script type="text/javascript" src="node_modules/require.js/require.js"></script> --> %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/axios/dist/axios.standalone.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/CryptoJS/rollups/hmac-sha256.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/CryptoJS/rollups/sha256.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/CryptoJS/components/hmac.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/CryptoJS/components/enc-base64.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/url-template/url-template.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/apiGatewayCore/sigV4Client.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/apiGatewayCore/apiGatewayClient.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/apiGatewayCore/simpleHttpClient.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/lib/apiGatewayCore/utils.js"></script>
<script type="text/javascript" src="vendor/assets/javascript/apigClient.js"></script>
<%# %# <script src="vendor/javascript/in.js"></script> %1> %>
<%= javascript_pack_tag "in" %>
<%= javascript_pack_tag "apigClient" %>
<%= javascript_pack_tag "search" %>

<script>
    if (('webkitSpeechRecognition' in window)) {
        console.log("webkit in window");
        var recognition = new webkitSpeechRecognition();

        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = "en";
        recognition.onresult = function (event) {
            for (var i = event.resultIndex; i < event.results.length; ++i) {
                if (event.results[i].isFinal) {
                    document.getElementById("level").value = document.getElementById("level").value + event.results[i][0].transcript;
                }
            }
        };
    }
</script>
<%# <script charset="utf-8"> %>
<%#   function submitChat(e) { %>
<%#           const host = "http://ec2-54-172-72-63.compute-1.amazonaws.com:5011/recommend?" %>
<%#           var level = document.getElementById('level').value; %>
<%#           var budget = document.getElementById('budget').value; %>
<%#           var email = document.getElementById('email').value; %>
  
<%#           if (level === "" || budget === "") { %>
<%#               result_area = document.getElementById('hardware_info'); %>
<%#               result_area.innerText = "Need level and budget" %>
<%#               return %>
<%#           } %>
          
<%#           var url = host + "level=" + level + "&budget=" + budget; %>
<%#           var params = { %>
<%#               "level": level, %>
<%#               "budget": budget %>
<%#           }; %>
  
<%#           var body = { %>
<%#           } %>
  
<%#           if (email !== "") { %>
<%#               url = url + "&email=" + email %>
<%#               params['email'] = email %>
<%#               console.log(url) %>
<%#           } %>
  
<%#           var apigClient = apigClientFactory.newClient(); %>
<%#           apigClient.recommendGet(params, body) %>
<%#               .then(function(result){ %>
<%#                   console.log(result['data']) %>
<%#                   const allHardwares = result['data']['body'] %>
<%#                   console.log(allHardwares) %>
<%#                   const hardwareNames = ["CPU", "GPU", "RAM", "SSD", "HDD", "USB"] %>
<%#                   document.getElementById('hardware_info').innerText = "Here is our recommendations: (More results are send to your email) \n"; %>
<%#                   for (let j = 0; j < hardwareNames.length; j++){ %>
<%#                       var hardwareName = hardwareNames[j] %>
<%#                       const hardwareList = allHardwares[hardwareName] %>
<%#                       const hardwareArea = document.getElementById(hardwareName) %>
<%#                       hardwareArea.innerText = hardwareName + ":\n " %>
<%#                       hardwareArea.innerText+=hardwareList[0] %>
<%#                   } %>
<%#               }).catch( function(result){ %>
<%#               console.log(JSON.stringify(result)) %>
<%#           }); %>
  
  
<%#           // const httpRequest = new XMLHttpRequest(); %>
<%#           // httpRequest.open('GET', url, true); %>
<%#           // httpRequest.send(); %>
<%#           // httpRequest.onreadystatechange = function () { %>
<%#           //     if (httpRequest.readyState === 4 && httpRequest.status === 200) { %>
<%#           //         const json = httpRequest.responseText; %>
<%#           //         const allHardwares = JSON.parse(json)['body'] %>
<%#           //         const hardwareNames = ["CPU", "GPU", "RAM", "SSD", "HDD", "USB"] %>
<%#           //         document.getElementById('hardware_info').innerText = "Here is our recommendations: (More results are send to your email) \n"; %>
<%#           //         for (let j = 0; j < hardwareNames.length; j++){ %>
<%#           //             var hardwareName = hardwareNames[j] %>
<%#           //             const hardwareList = allHardwares[hardwareName] %>
<%#           //             const hardwareArea = document.getElementById(hardwareName) %>
<%#           //             hardwareArea.innerText = hardwareName + ":\n " %>
<%#           //             hardwareArea.innerText+=hardwareList[0] %>
<%#           //         } %>
<%#           //     } %>
<%#           // }; %>
<%#       } %>
  
<%#   </script> %>

<body>
<header>
    <div class="title">
        <h1>Start to build my PC</h1>
    </div>
 </header>

<div class="row">
    <div class="column" id="searchArea">
        <label for="level">Enter your level (gamer, common user, student)</label>
        <div>
            <input type="text" id="level" name="search-level">
        </div>
        <label for="budget">Enter your budget</label>
        <div>
            <input type="text" id="budget" name="search-budget">
        </div>
        <label for="email">Enter your email</label>
        <div>
            <input type="text" id="email" name="search-email">
        </div>
        <%# <input class="btn" type="button" id="submit" value="Search" onclick=<% javascript_tag "submitChat()" %1>> %>
        <%# <%= button_tag "search", '<% javascript_tag "submitChat()" %1>', :class => "buttonGrey" %1> %>
        <%= button_tag "Do It", type: 'button', onclick: "submitChat()", class: 'btn btn-default' %>
    </div>

    <div class="column" id="topSets">
        <p id="top_header">
            <i class="fa fa-trophy" style="color: rgb(212, 155, 12)"></i> Top Hits
            <i class="fa fa-trophy" style="color: rgb(212, 155, 12)"></i>
        </p>
        <div id="top_hardware_info">
            <b>Top CPU: </b>
            <div id="top_CPU"></div>
            <b>Top GPU: </b>
            <div id="top_GPU"></div>
            <b>Top RAM: </b>
            <div id="top_RAM"></div>
            <b>Top SSD: </b>
            <div id="top_SSD"></div>
            <b>Top HDD: </b>
            <div id="top_HDD"></div>
            <b>Top USB: </b>
            <div id="top_USB"></div>
        </div>
        
        
    </div>
</div>

<div class="recommendations">
    <div id="hardware_info"></div>
    <div id="CPU"><br></div>
    <div id="GPU"><br></div>
    <div id="RAM"><br></div>
    <div id="SSD"><br></div>
    <div id="HDD"><br></div>
    <div id="USB"><br></div>
</div>

</body>

<footer>
    <div class="copyright">
        By Ruihan Yu, Junqi Zhang, Yuanqi Dan, Tracy Li, Jiawen Li, Yuerong Zhang, Chang Gao.
    </div>
</footer>
</html>
